<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    <title>Year Group Clustering – Tom Hohenstein – A place for my experiments</title>

    <meta name="author" content="Tom Hohenstein" />
    <meta name="description" content="A place for my experiments">

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- add bootstrap --> 
    <link href="/assets/css/l/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">
    
    
    
   </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        
        <div class="navbar-header">
          <div id="brand-holder">
            <a class="navbar-brand" href="http://tomhohenstein.com" id="logo" ><sup>T</sup><sub>H</sub></a>
          </div>
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#hamburger">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse" id="hamburger"> 
            <ul class="nav navbar-nav">
              <li><a class="custom-navbar-link" href="/about/">About</a></li>
              <li><a class="custom-navbar-link" href="/blog/">Blog</a></li>
              <li><a class="custom-navbar-link" href="/projects/">Projects</a></li>
            </ul>
          </div>
    
         </div>
      </div><!-- /.container-fluid -->
    </nav>
    <div id="body-wrapper">
    <article class="post col-md-6 col-md-offset-3">
	<h1>Year Group Clustering</h1>
	<div class="entry">
		<p>This project should be a fun one. I have always wanted to see what classes first year students take and how that is distributed by subject. Are a lot of first year students taking clasess in math? biology? history? If this project is successful, we will accomplish just that feat. </p>

<p>Resources: </p>

<ul>
  <li><a href="http://bl.ocks.org/mbostock/1747543">Mike Bostock’s Clustered Force Layout 1</a> on bl.ocks.org</li>
  <li><a href="http://stackoverflow.com/questions/23022429/create-node-clusters-focal-points-by-data-attribute-in-d3">Stackoverflow Question anwser</a></li>
</ul>

<p>Tasks: Build a demo cluster graph</p>

<div id="svg"></div>

<h2 id="structuring-the-data">Structuring the Data</h2>

<p>Detail how the data is structured </p>

<h2 id="javascript-tips">JavaScript tips</h2>

<p>Dynamically locating the largest node within a cluster </p>

<p>Moving nodes of a same cluster towards each other. </p>

<style>
.link {
    stroke: #777;
    stroke-width: 2px;
}
</style>

<!-- load d3 -->
<script src="/projects/instruction-network/d3/d3.min.js"></script>

<script>
//canvas size 
var width = 500,
    height = 500,
    padding = 10,
    clusterPadding =5,
    maxRadius = 40;

var data = {
	"nodes":[
		{
			"index": 0, 
			"color": "red", 
			"size": 50, 
			"labal": "class", 
			"cluster": "MA"
		},
		{
			"index": 1, 
			"color": "red", 
			"size": 3, 
			"labal": "class 1",
			"cluster": "MA"
		},
		{
			"index": 2, 
			"color": "blue", 
			"size": 10, 
			"labal": "class 2",
			"cluster": "BIO"
		},
		{
			"index": 3, 
			"color": "blue", 
			"size": 5, 
			"labal": "class 3",
			"cluster": "BIO"
		},
		{
			"index": 4, 
			"color": "blue", 
			"size": 5, 
			"labal": "class 3",
			"cluster": "BIO"
		},
		{
			"index": 5, 
			"color": "orange", 
			"size": 39, 
			"labal": "class 3",
			"cluster": "CHEM"
		}, 
		{
			"index": 6, 
			"color": "orange", 
			"size": 9, 
			"labal": "class 3",
			"cluster": "CHEM"
		},
		{
			"index": 7, 
			"color": "green", 
			"size": 9, 
			"labal": "class 3",
			"cluster": "SPAN"
		}
		],
	"links":[
		{
			"source":0,
			"target":1
		}]
	}; 

	//add svg to dom 
	var svg = d3.select("#svg").append("svg")
    			.attr("width", width)
    			.attr("height", height);

	//load d3 force 
	var force = d3.layout.force()
				.size([width, height]) //size
				.gravity(0.4) //gravity
				.charge(function(d){ return  d.size * -30 }) //charge between elements
				.nodes(data.nodes)
				.on("tick", tick)
				.on("end", end)
				.start(); 


	//draw nodes - issue with x, y 
	var node = svg.selectAll('.node')
					.data(data.nodes)
					.enter().append('circle')
					.attr('class','node')
					.attr('class',function(d) {return d.cluster})
					.attr('r', function(d) { return d.size; })
					.style('fill',function(d) {return d.color})
					.style('stroke',function(d) {return d.color})
					.call(force.drag);
/*
	var clusters = d3.nest()
					.key(function(d){ return d.cluster;})
					.map(data.nodes);
	
	var clusters = [{ cluster : index of biggest node },
					{ cluster : index of biggest node}]
					var center = d3.entries(clusters); 


	console.log(clusters); 


	//console.log("size " + data.nodes[i].size);
		//clusters[data.nodes[i].cluster] = data.nodes[i].size;
		console.log("cluster " + typeof(clusters[data.nodes[i].cluster]) + clusters[data.nodes[i].cluster]);

	console.log("clusters size" + clusters[data.nodes[i].cluster]);
		console.log("size " + typeof(data.nodes[i].size) + data.nodes[i].size);
		
		//clusters[data.nodes[i].cluster] = data.nodes[i].size;
		console.log("cluster in data.nodes " + data.nodes[i].cluster)
		console.log("cluster in clusters " + clusters[data.nodes[i].cluster])
			

*/

	
	//build clusters object to hold cluster name and largest node
	var clusters = {};
		for (i in data.nodes){
		if(typeof(clusters[data.nodes[i].cluster]) === "undefined" ){
			clusters[data.nodes[i].cluster] = 0; 
			console.log("zero for " + data.nodes[i].cluster);
		}
		if(data.nodes[i].size > clusters[data.nodes[i].cluster]){
			clusters[data.nodes[i].cluster] = data.nodes[i].size;
			console.log(data.nodes[i].cluster + " is now " + data.nodes[i].size);
		} 
	}
		
	//turn force on and sent function for each tick
	function tick(e){
		var k = e.alpha * .1;
		var c = {}; 
	  	data.nodes.forEach(function(n) {
	  		 if(clusters[n.cluster] == n.size){
	  		 	c[n.cluster] = {"x": n.x, "y":n.y};
	  		 } 
	    	n.x += (c[n.cluster].x - n.x) * k;
	    	n.y += (c[n.cluster].y - n.y) * k;
  	  	});
		
   		node.attr("cx", function(d) { return d.x; })
      		.attr("cy", function(d) { return d.y; });
  
	}

	function end(e){
		//alert(data.nodes);
	}
	// Move d to be adjacent to the cluster node.

</script>


	</div>
  	<div class="social-share">
	  	<span>Share:</span>
	  	<a href="https://twitter.com/share?text=Year Group Clustering&url=http://tomhohenstein.com/projects/year-group-clustering/index.html&via=tomhohenstein"><img alt="..." class="footer-icon" src="/assets/img/social-icons/twitter.png"></a>
	  	<a href="https://plus.google.com/share?url=http://tomhohenstein.com/projects/year-group-clustering/index.html&hl=en-US" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><img alt="..." class="footer-icon" src="/assets/img/social-icons/google.png"></a>
	  	<a href="http://www.linkedin.com/shareArticle?mini=true&url=http://tomhohenstein.com/projects/year-group-clustering/index.html&title=Year Group Clustering&source=&summary="><img alt="..." class="footer-icon" src="/assets/img/social-icons/linkedin.png"></a>
	  	<a href="https://www.facebook.com/dialog/share?app_id=946372735391329&display=popup&href=http://tomhohenstein.com/projects/year-group-clustering/index.html&redirect_uri=http://tomhohenstein.com/projects/year-group-clustering/index.html"><img alt="..." class="footer-icon" src="/assets/img/social-icons/facebook.png"></a>
	</div> 
</article>
    </div>
    <footer class="row">
      <div>
        <p>Find me on</p>
        <a href="https://www.linkedin.com/in/hohenstein/"><img alt="LinkedIn Icon" class="footer-icon" src="/assets/img/footer-icons/LinkedIn-InBug-2CRev.png"></a> 
        <a href="https://github.com/tomhohenstein"><img alt="GitHub Icon" class="footer-icon" height=50 src="/assets/img/footer-icons/GitHub-Mark-120px-plus.png" width=50></a>
        <a href="https://twitter.com/TomHohenstein"><img alt="Twitter Icon" class="footer-icon"  src="/assets/img/footer-icons/Twitter_logo_blue.png" ></a>
      </div> 
    </footer>

    <script src="/assets/js/l/jquery-1.11.1.js"></script>
    <script src="/assets/js/l/bootstrap.min.js"></script>
    <script src="/assets/js/l/jquery.mobile.custom.touch.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-51252936-1', 'auto');
      ga('send', 'pageview');
    </script>
    
  </body>
</html>